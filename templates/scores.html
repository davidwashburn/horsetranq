<!doctype html>
<html lang="en" class="no-js bg-primary">
	<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
		<link rel="preconnect" href="https://fonts.googleapis.com">
		<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
		<link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;500;600;700;900&display=swap" rel="stylesheet">
		<link rel="icon" type="image/x-icon" href="/static/img/assets/ico/hors.ico">
		<link rel="stylesheet" href="/static/css/reset.css"> <!-- CSS reset -->
		<link rel="stylesheet" href="/static/css/style.css"> <!-- Resource style -->
		<link rel="stylesheet" href="/static/css/variables.css"> <!-- Variables style -->
		<link rel="stylesheet" href="/static/css/style-v3.css"> <!-- New v3 style -->
		<script src="/static/js/resources/modernizr.js"></script> <!-- Modernizr -->
		<script src="https://cdn.auth0.com/js/auth0/9.18/auth0.min.js"></script>
		<script src="https://cdn.auth0.com/js/auth0-spa-js/2.0/auth0-spa-js.production.js"></script>
		<title>Scors - HOrstRnq</title>
	</head>
	<body>

		<main id="scores" class="main-content">
			{% include 'partials/navigation_menu.html' %}

			<!-- Scores Main Section -->
			<div class="main-wrapper" data-animate="page-intro">
				<div class="hero-section margin-auto-desktop margin-auto-phone margin-auto-tablet width-lg-desktop width-md-tablet width-xl-phone">
					<div class="flex-row-desktop flex-column-phone flex-align-center flex-justify-center gap-xxl-all">
						<!-- WEEKLY LEADERS Column -->
						<div id="hero-square" class="width-full-phone width-md-desktop width-md-tablet margin-auto-phone margin-auto-tablet border-radius rotate-left-desktop shadow-green-md">
							<div class="flex-column-desktop flex-column-phone flex-justify-center flex-align-items-start width-full-all">
								<h3 class="margin-md-desktop margin-sm-phone margin-md-tablet font-size-md font-weight-xl color-accent-white">WEEKLY LEADERS</h3>
								
								<!-- Most games -->
								<div class="data-item flex-row-desktop flex-row-phone flex-justify-space-between flex-align-items-center margin-sm-desktop margin-sm-phone margin-sm-tablet">
									<h4 class="font-size-md font-weight-xl color-accent-white">Most games</h4>
									<p class="font-size-md font-weight-md color-accent-white">{{ weekly_leaders.most_games.username }} ({{ weekly_leaders.most_games.games }})</p>
								</div>

								<!-- Most horses -->
								<div class="data-item flex-row-desktop flex-row-phone flex-justify-space-between flex-align-items-center margin-sm-desktop margin-sm-phone margin-sm-tablet">
									<h4 class="font-size-md font-weight-xl color-accent-white">Most horses</h4>
									<p class="font-size-md font-weight-md color-accent-white">{{ weekly_leaders.most_horses.username }} ({{ weekly_leaders.most_horses.horses }})</p>
								</div>

								<!-- Fastest time -->
								<div class="data-item flex-row-desktop flex-row-phone flex-justify-space-between flex-align-items-center margin-sm-desktop margin-sm-phone margin-sm-tablet">
									<h4 class="font-size-md font-weight-xl color-accent-white">Fastest time</h4>
									<p class="font-size-md font-weight-md color-accent-white">
										{% if weekly_leaders.fastest_time.time %}
											{{ weekly_leaders.fastest_time.username }} ({{ "%.1f"|format(weekly_leaders.fastest_time.time) }}s)
										{% else %}
											{{ weekly_leaders.fastest_time.username }}
										{% endif %}
									</p>
								</div>

								<!-- Most improved -->
								<div class="data-item flex-row-desktop flex-row-phone flex-justify-space-between flex-align-items-center margin-sm-desktop margin-sm-phone margin-sm-tablet">
									<h4 class="font-size-md font-weight-xl color-accent-white">Most improved</h4>
									<p class="font-size-md font-weight-md color-accent-white">Coming soon</p>
								</div>
							</div>
						</div>
						
						<!-- WEEKLY STATS Column -->
						<div id="hero-square" class="width-full-phone width-md-tablet margin-auto-phone margin-auto-tablet border-radius rotate-right-desktop shadow-green-md width-full-tablet">
							
							<div class="flex-column-desktop flex-column-phone flex-justify-center flex-align-items-start width-full-all">
								<h3 class="margin-md-desktop margin-sm-phone margin-md-tablet font-size-md font-weight-xl color-accent-white">WEEKLY STATS</h3>
								
								<!-- Total games played -->
								<div class="data-item flex-row-desktop flex-row-phone flex-justify-space-between flex-align-items-center margin-sm-desktop margin-sm-phone margin-sm-tablet">
									<h4 class="font-size-md font-weight-xl color-accent-white">Total gams plaid</h4>
									<p class="font-size-md font-weight-md color-accent-white">{{ aggregated_stats.total_games }}</p>
								</div>

								<!-- Total horses tranquilized -->
								<div class="data-item flex-row-desktop flex-row-phone flex-justify-space-between flex-align-items-center margin-sm-desktop margin-sm-phone margin-sm-tablet">
									<h4 class="font-size-md font-weight-xl color-accent-white">Hors tranquilized</h4>
									<p class="font-size-md font-weight-md color-accent-white">{{ aggregated_stats.total_horses }}</p>
								</div>

								<!-- Best time ever -->
								<div class="data-item flex-row-desktop flex-row-phone flex-justify-space-between flex-align-items-center margin-sm-desktop margin-sm-phone margin-sm-tablet">
									<h4 class="font-size-md font-weight-xl color-accent-white">Best time evar</h4>
									<p class="font-size-md font-weight-md color-accent-white">
										{% if aggregated_stats.best_time_ever %}
											{{ "%.1f"|format(aggregated_stats.best_time_ever) }}s
										{% else %}
											No data
										{% endif %}
									</p>
								</div>

								<!-- Active players -->
								<div class="data-item flex-row-desktop flex-row-phone flex-justify-space-between flex-align-items-center margin-sm-desktop margin-sm-phone margin-sm-tablet">
									<h4 class="font-size-md font-weight-xl color-accent-white">Active players</h4>
									<p class="font-size-md font-weight-md color-accent-white">{{ aggregated_stats.active_players }}</p>
								</div>
							</div>
						</div>
					</div>
				</div>

				<!-- Scores Section -->
				<div class="main-section margin-auto-desktop margin-auto-phone margin-auto-tablet width-full-desktop width-full-tablet width-full-phone bg-primary-dark" data-animate="page-intro">
											<div class="flex-column-desktop flex-column-phone flex-align-center flex-justify-center width-lg-desktop margin-auto-desktop margin-md-phone margin-auto-tablet gap-sm-all">
						<h3 class="margin-md-desktop margin-sm-phone margin-md-tablet font-size-lg font-weight-xl color-accent-white text-center">GLOBAL SCOREBOARD</h3>
						
						<div class="overflow-scroll width-full-all">
						<table class="scoreboard-table margin-sm-desktop margin-sm-phone margin-sm-tablet width-full-all">
							<thead>
								<tr class="margin-sm-desktop margin-sm-phone margin-sm-tablet">
									<th class="font-size-sm font-weight-xl color-accent-white text-center">#</th>
									<th class="font-size-sm font-weight-xl color-accent-white text-left">Username</th>
									<th class="font-size-sm font-weight-xl color-accent-white text-center">Games</th>
									<th class="font-size-sm font-weight-xl color-accent-white text-center">All hors</th>
									<th class="font-size-sm font-weight-xl color-accent-white text-center">Best Time</th>
									<th class="font-size-sm font-weight-xl color-accent-white text-center">HorsPass</th>
									<th class="font-size-sm font-weight-xl color-accent-white text-center">Subscription</th>
								</tr>
							</thead>
							<tbody>
								{% if scoreboard %}
									{% for entry in scoreboard %}
									<tr class="margin-sm-desktop margin-sm-phone margin-sm-tablet">
										<td class="font-size-md font-weight-xl {% if loop.index == 1 %}color-accent-gold{% elif loop.index == 2 %}color-accent-grey-mid{% else %}color-accent-white{% endif %} text-center">{{ loop.index }}</td>
										<td class="font-size-md font-weight-xl color-accent-white text-left">
											<h4 class="font-size-md font-weight-xl color-accent-white">{{ entry.username or 'Unknown' }}</h4>
										</td>
										<td class="font-size-md font-weight-md color-accent-white text-center">{{ entry.total_games or 0 }}</td>
										<td class="font-size-md font-weight-md color-accent-white text-center">{{ entry.total_horses or 0 }}</td>
										<td class="font-size-md font-weight-md color-accent-white text-center">
											{% if entry.best_time_seconds %}
												{{ "%.1f"|format(entry.best_time_seconds) }}s
											{% else %}
												-
											{% endif %}
										</td>
										<td class="font-size-md font-weight-md color-accent-white text-center">Level {{ entry.horspass_level or 1 }}</td>
										<td class="font-size-md font-weight-md text-center">
											{% if entry.subscription_type == 'max' %}
												<span class="font-size-sm font-weight-xl bg-accent-gold color-accent-grey-dark" style="padding: 2px 6px; border-radius: 4px;">MAX</span>
											{% elif entry.subscription_type == 'plus' %}
												<span class="font-size-sm font-weight-xl bg-secondary color-accent-white" style="padding: 2px 6px; border-radius: 4px;">PLUS</span>
											{% elif entry.subscription_type == 'one' %}
												<span class="font-size-sm font-weight-xl bg-success-dark color-accent-white" style="padding: 2px 6px; border-radius: 4px;">ONE</span>
											{% else %}
												<span class="font-size-sm font-weight-xl bg-accent-grey-mid color-accent-grey-dark" style="padding: 2px 6px; border-radius: 4px;">FREE</span>
											{% endif %}
										</td>
									</tr>
									{% endfor %}
								{% else %}
									<tr class="margin-sm-desktop margin-sm-phone margin-sm-tablet">
										<td colspan="7" class="font-size-md font-weight-md color-accent-white text-center">No scoreboard data available</td>
									</tr>
								{% endif %}
							</tbody>
						</table>
						</div> <!-- end overflow-scroll -->

					</div>
				</div>
			</div>
		

		</main> <!-- main-content -->

		<script src="https://code.jquery.com/jquery-3.7.1.min.js" integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo=" crossorigin="anonymous"></script>
		<script type="module" src="/static/js/main.js"></script> <!-- Resource jQuery -->
		<script>
			// Make logged in status available to JavaScript
			window.loggedIn = {{ 'true' if logged_in else 'false' }};
		</script>
		<script src="/static/js/secondary/username-editor.js"></script> <!-- Username editing functionality -->
		<script src="/static/js/secondary/account-button.js"></script> <!-- Account button avatar functionality -->
		<script src="/static/js/secondary/hide-avatar.js"></script> <!-- Hide avatar checkbox functionality -->
	</body>
</html>
